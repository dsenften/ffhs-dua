= uv: Der moderne Python-Paketmanager und -Builder
include::common/header.adoc[]

:uv: https://github.com/astral-sh/uv
:poetry: https://python-poetry.org/
:pip: https://pip.pypa.io/

image::https://img.shields.io/badge/uv-FFD43B?logo=python&logoColor=blue&style=for-the-badge[uv,link=https://github.com/astral-sh/uv]

== Einführung

`uv` ist ein schneller Python-Paketmanager und -Builder, der in Rust geschrieben wurde. Er wurde von den Machern von `ruff` entwickelt und bietet eine moderne Alternative zu `pip` und `poetry`. Mit `uv` können Sie Python-Pakete schneller installieren, virtuelle Umgebungen verwalten und Python-Projekte bauen und veröffentlichen.

[discrete]
=== In diesem Tutorial lernen Sie

- Installation von `uv` auf verschiedenen Systemen
- Initialisierung neuer Python-Projekte mit `uv`
- Python-Versionen verwalten mit `uv`
- Moderne Paketmanagement-Workflows
- Grundlegende Befehle für das Paketmanagement
- Vergleich von `uv` mit `pip` und `poetry`
- Verwendung von `uv` in bestehenden Projekten
- Erstellen und Verwalten virtueller Umgebungen
- Builden und Veröffentlichen von Paketen

=== Warum uv?

* **Schneller** als herkömmliche Python-Paketmanager
* **Kompilierung in Rust** für bessere Leistung
* **Kompakte Binärdatei** ohne Python-Abhängigkeiten
* **Drop-in-Ersatz** für `pip` und `pip-tools`
* **Schnellere Installation** von Paketen durch parallele Downloads
* **Bessere Fehlermeldungen** und Benutzererfahrung
* **Unterstützung** für `pyproject.toml` und `requirements.txt`

== Installation

=== Systemvoraussetzungen

* Python 3.8 oder höher
* Linux, macOS oder Windows
* Für optimale Leistung: Python 3.9+

=== Installation über Homebrew (macOS) - Empfohlen

Für macOS-Benutzer ist Homebrew die bequemste Installationsmethode:

[source,bash]
----
brew install uv
----

NOTE: Nach der Installation mit Homebrew müssen Sie möglicherweise den PATH konfigurieren. Führen Sie `uv tool update-shell` aus, um dies automatisch zu erledigen.

=== Installation über pip

Die einfachste plattformübergreifende Möglichkeit:

[source,bash]
----
pip install uv
----

=== Installation über curl (Linux/macOS)

Direkte Installation vom offiziellen Installer:

[source,bash]
----
curl -LsSf https://astral.sh/uv/install.sh | sh
----

Diese Methode konfiguriert automatisch den PATH in `~/.zshenv`.

=== Installation über pipx (alle Plattformen)

Für isolierte Installation:

[source,bash]
----
pipx install uv
----

=== Installation unter Windows

==== PowerShell (empfohlen)

[source,powershell]
----
irm https://astral.sh/uv/install.ps1 | iex
----

==== Über pip

[source,bash]
----
pip install uv
----

==== Über winget

[source,bash]
----
winget install astral-sh.uv
----

=== Überprüfung der Installation

[source,bash]
----
uv --version
----

== Python-Versionen verwalten

`uv` kann Python-Versionen automatisch installieren und verwalten:

=== Python-Version anzeigen

[source,bash]
----
uv python list
----

=== Spezifische Python-Version installieren

[source,bash]
----
uv python install 3.12
uv python install 3.11.5
----

=== Python-Version für Projekt festlegen

[source,bash]
----
uv python pin 3.12
----

== Neue Projekte initialisieren

=== Neues Projekt erstellen

[source,bash]
----
# Neues Projekt im aktuellen Verzeichnis
uv init

# Neues Projekt in neuem Verzeichnis
uv init mein-projekt
cd mein-projekt
----

Dies erstellt:
- `pyproject.toml` - Projektkonfiguration
- `README.md` - Projektdokumentation
- `src/` - Source-Code-Verzeichnis
- `.python-version` - Gepinnte Python-Version

=== Projekt mit Abhängigkeiten hinzufügen

[source,bash]
----
# Abhängigkeit hinzufügen
uv add requests pandas

# Entwicklungsabhängigkeiten hinzufügen
uv add pytest black --dev
----

=== Projekt synchronisieren

[source,bash]
----
# Alle Abhängigkeiten installieren
uv sync

# Ohne Entwicklungsabhängigkeiten
uv sync --no-dev
----

=== Code ausführen

[source,bash]
----
# Python-Skript mit uv ausführen
uv run python main.py

# Direkt ein Modul ausführen
uv run pytest
----

== Grundlegende Verwendung (Legacy-Modus)

=== Pakete installieren

Installieren von Paketen ähnlich wie mit `pip`:

[source,bash]
----
uv pip install requests pytest
----

=== Virtuelle Umgebungen

Erstellen einer neuen virtuellen Umgebung:

[source,bash]
----
uv venv .venv
----

Aktivieren der virtuellen Umgebung:

[source,bash]
----
# Auf Unix/macOS
source .venv/bin/activate

# Auf Windows
.venv\\Scripts\\activate
----

=== Mit requirements.txt

[source,bash]
----
uv pip install -r requirements.txt
----

=== Mit pyproject.toml

[source,bash]
----
uv pip install -e .
----

== Vergleich: uv vs pip vs poetry

=== Geschwindigkeit

* `uv` ist deutlich schneller als `pip` und `poetry`
* Parallele Paketinstallation
* Effizienteres Caching

=== Funktionen

|===
| Feature | uv | pip | poetry
| Parallele Installation | ✓ | ✗ | ✗
| Lock-Dateien | ✓ | ✗ | ✓
| Abhängigkeitsauflösung | ✓ | Eingeschränkt | ✓
| Virtuelle Umgebungen | ✓ | ✓ | ✓
| Build-System | ✓ | ✗ | ✓
| Publishing | Eingeschränkt | ✗ | ✓
|===

=== Kompatibilität

* `uv` ist weitgehend kompatibel mit `pip` und `pip-tools`
* Unterstützt `requirements.txt` und `pyproject.toml`
* Kann in bestehenden Projekten parallel zu `pip` verwendet werden

== Fortgeschrittene Nutzung

=== Lock-Dateien erstellen

[source,bash]
----
uv pip compile requirements.in -o requirements.txt
----

=== Abhängigkeiten aktualisieren

[source,bash]
----
uv pip install --upgrade-package package_name
----

=== Entwicklungsumgebung einrichten

[source,bash]
----
uv pip install -e ".[dev]"
----

== Zusammenarbeit der Tools

=== Können pip, poetry und uv zusammen verwendet werden?

Grundsätzlich ist es technisch möglich, `pip`, `poetry` und `uv` im selben Projekt zu verwenden, aber es gibt wichtige Überlegungen:

1. **Nicht gleichzeitig verwenden**
   - Vermeiden Sie es, die Tools parallel für das gleiche virtuelle Environment zu verwenden
   - Jedes Tool verwaltet Abhängigkeiten auf seine eigene Weise
   - Parallele Nutzung kann zu Inkonsistenzen führen

2. **Empfohlener Ansatz**
   - Wählen Sie ein Haupttool für das Dependency-Management
   - Nutzen Sie die anderen Tools nur für spezifische Aufgaben
   - Dokumentieren Sie die gewählte Vorgehensweise im Projekt

3. **Typische Kombinationen**

   ** *Poetry + uv* (empfohlen):
   - Verwenden Sie `poetry` für die Abhängigkeitsverwaltung
   - Nutzen Sie `uv` als schnellen `pip`-Ersatz für Installationen
   - Beispiel:
+
[source,bash]
----
# Mit poetry Abhängigkeiten definieren
poetry add package

# Mit uv schnell installieren
uv pip install -r requirements.txt
----
+
   ** *Nur uv* (für einfache Projekte):
   - Nutzen Sie `uv` als vollständigen Ersatz für `pip`
   - Ideal für einfache Projekte ohne komplexe Abhängigkeiten
   +
   ** *Poetry + pip* (traditionell):
   - Verwenden Sie `poetry` für das Management
   - Nutzen Sie `pip` für spezielle Fälle

4. **Best Practices**

   - Halten Sie sich an ein konsistentes Toolset pro Projekt
   - Dokumentieren Sie die verwendeten Tools in der `README.md`
   - Nutzen Sie `.gitignore` für tool-spezifische Dateien
   - Vermeiden Sie manuelle Änderungen an `pyproject.toml` oder `poetry.lock`
   - Verwenden Sie in CI/CD-Pipelines das gleiche Tool wie lokal

5. **Wann welches Tool verwenden?**
+
|===
| Anwendungsfall | Empfohlenes Tool | Alternative
| Neue Projekte mit Abhängigkeiten | `poetry` | `uv`
| Einfache Skripte | `uv` | `pip`
| CI/CD-Pipelines | `uv` (schneller) | `pip`
| Komplexe Abhängigkeiten | `poetry` | 
| Legacy-Projekte | `pip` | 
|===

6. **Warnhinweise**
   - Vermeiden Sie es, `pip install` in einer mit `poetry` verwalteten Umgebung zu verwenden
   - Seien Sie vorsichtig bei der manuellen Bearbeitung von `pyproject.toml`
   - Führen Sie nach Tool-Wechsel immer einen sauberen Neustart durch

== Best Practices

1. **Verwenden Sie `uv` für schnelle Installationen** in CI/CD-Pipelines
2. **Kombinieren Sie mit `poetry`** für besseres Dependency Management
3. **Nutzen Sie `.gitignore`** für `.venv/` und `__pycache__/`
4. **Dokumentieren Sie die Installation** von `uv` in Ihrer README
5. **Aktualisieren Sie regelmäßig** `uv` selbst

== Fehlerbehebung

=== Häufige Probleme

1. **Berechtigungsprobleme**
   - Verwenden Sie `--user` oder virtuelle Umgebungen

2. **Inkompatible Pakete**
   - Versuchen Sie es mit `--no-deps` und installieren Sie Abhängigkeiten manuell

3. **Netzwerkprobleme**
   - Überprüfen Sie Ihre Internetverbindung
   - Verwenden Sie `--timeout` für langsame Verbindungen

== Cheat Sheet - Wichtigste Befehle

=== Installation und Setup

[source,bash]
----
# Installation (macOS mit Homebrew)
brew install uv

# Installation (andere Plattformen)
pip install uv
curl -LsSf https://astral.sh/uv/install.sh | sh  # Linux/macOS
pipx install uv                                  # Isolierte Installation

# PATH konfigurieren (falls nötig)
uv tool update-shell

# Version prüfen
uv --version

# Python-Versionen verwalten
uv python list
uv python install 3.12
uv python pin 3.12
----

=== Neue Projekte

[source,bash]
----
# Neues Projekt erstellen
uv init
uv init mein-projekt

# Abhängigkeiten hinzufügen
uv add requests pandas
uv add pytest --dev

# Projekt synchronisieren
uv sync
uv sync --no-dev

# Code ausführen
uv run python main.py
uv run pytest
----

=== Legacy-Modus (pip-Ersatz)

[source,bash]
----
# Virtuelle Umgebung erstellen
uv venv .venv

# Aktivieren (Unix/macOS)
source .venv/bin/activate

# Aktivieren (Windows)
.venv\Scripts\activate

# Pakete installieren
uv pip install requests pytest
uv pip install -r requirements.txt
uv pip install -e .

# Abhängigkeiten kompilieren
uv pip compile requirements.in -o requirements.txt
----

=== Nützliche Optionen

[source,bash]
----
# Upgrade einzelner Pakete
uv pip install --upgrade-package package_name

# Entwicklungsabhängigkeiten
uv pip install -e ".[dev]"

# Timeout für langsame Verbindungen
uv pip install --timeout 120 package_name

# Benutzerweite Installation
uv pip install --user package_name
----

== Fazit

`uv` ist eine leistungsstarke Ergänzung zum Python-Ökosystem, das die Geschwindigkeit der Paketverwaltung erheblich verbessert. Während es noch nicht alle Funktionen von `poetry` abdeckt, ist es eine ausgezeichnete Wahl für schnelle Installationen und CI/CD-Pipelines.

== Nächste Schritte

- https://github.com/astral-sh/uv[Offizielle Dokumentation]
- https://github.com/astral-sh/uv#benchmarks[Benchmarks]
- https://github.com/astral-sh/uv/blob/main/CONTRIBUTING.md[Beitragen zum Projekt]

== Glossar

* **uv**: Ein schneller Python-Paketmanager und -Builder
* **pip**: Der Standard-Paketmanager für Python
* **poetry**: Ein Tool für Abhängigkeitsverwaltung und Packaging
* **Virtuelle Umgebung**: Isolierte Python-Umgebung für Projekte
* **Lock-Datei**: Datei mit exakten Versionen aller Abhängigkeiten
